<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Super balance calculator</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="icon" href="./favicon.ico" type="image/x-icon">
  </head>
  <body>
    <main>
        <h1>Super balance calculator</h1>  
        <p>
            <label>Years</label>
            <input type="number" id="years" value = "20">
        </p>
        <p>
            <label>Complusory Super rate %</label>
            <input type="number" id="superRate" value="12"/>
        </p>
        
        <p>
            <label>Wage price index %</label>
            <input type="number" id="wpi" value="3"/>
        </p>
        <p>
            <label>Return on investment %</label>
            <input type="number" id="roi" value="8"/>
        </p>
        <p>
            <label>Super Fees (% of balance) </label>
            <input type="number" id="fees" value="0.1"/>
        </p>
        <p>
            <label>Other fixed super fees </label>
            <input type="number" id="feesFixed" value="500"/>
        </p>
        <p>
            <label>Tax rate % </label>
            <input type="number" id="tax" value="15"/>
        </p>
        <p>
            <label>Salary (yearly)</label>
            <input type="number" id="salary" value = "0" step="10000"/>
        </p>
        <p>
            <label>Other super contributions</label>
            <input type="number" id="superOther" value="0" step="1000"/>
        </p>
        <p>
            <label>Current super balance</label>
            <input type="number" id="balance" value="0" step="50000"/>
        </p>
        <p>
            <label>Current age</label>
            <input type="number" id="age" value="18"/>
        </p>
        <button onclick="calculate()" >Calculate</button>
        <div>
            <span id="results"></span>
        </div>
        
    </main>
    <script src="index.js"></script>
  </body>
  <script>
    function get(id) {
        return Number(document.getElementById(id).value)
    }
    function fmt(number) {
        return new Intl.NumberFormat('en-AU', { style: 'currency', currency: 'AUD' }).format(
            number,
        )
    }
    function calculate() {
        const years = get("years")
        let salary = get("salary")
        const super_rate = get("superRate") / 100
        const super_additional = get("superOther")
        const wpi = get("wpi") / 100
        const roi = get("roi") / 100
        let balance = get("balance")
        const fees = get("fees") / 100
        const insurance = get("feesFixed")
        const tax = get("tax") / 100
        const age = get("age")
        let inflation = 0
        const results = document.getElementById("results")
        const currentYear = new Date().getFullYear() 
        results.innerHTML = ""
        for(let i =1; i < years; i++) {
            let contrib = (salary * super_rate) + super_additional
            contrib -= contrib * tax

            balance += contrib

            let earnings = balance * roi
            earnings -= earnings * tax

            balance += balance * roi
            balance -= balance * fees
            balance -= insurance
            if (balance < 0) balance = 0

            inflation += (balance * 0.03)

            salary += salary * wpi
            const resultText = `Year: ${currentYear+i} Age: ${age+i} - Balance: ${fmt(balance)}. Balance (Inflation Adjusted): ${fmt(balance * 1.03 ** -i)}.  Salary: ${fmt(salary)}`
            console.log(resultText)
            
            results.innerHTML += resultText + "<br/>" 
        }
    }
  </script>
</html>